<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manage SpeedCode Problems</title>
  <link rel="stylesheet" href="../css/speedCode.css">
</head>
<body>
  <h1>Manage SpeedCode Problems</h1>

  <!-- Event Controls Section -->
<section id="event-controls-section" style="margin-bottom:2em;">
  <h2>Event Controls</h2>
  <div id="event-controls-status">
    <!-- Status will be loaded here -->
  </div>
  <div id="event-controls-actions" style="margin-top:1em;">
    <button id="toggle-active-btn" class="toggle-btn">Start/Stop Event</button>
    <button id="toggle-lock-btn" class="toggle-btn">Lock/Unlock Submissions</button>
    <button id="toggle-leaderboard-btn" class="toggle-btn">Show/Hide Leaderboard</button>
  </div>
</section>
  
  <!-- Problem List -->
  <section id="problems-list-section">
    <h2>Current Problems</h2>
    <ul id="problems-list"></ul>
  </section>
  <button onclick="viewTestCases('PROBLEM_ID')">View Test Cases</button>

  <!-- Add/Edit Problem Form -->
  <section id="problem-form-section">
    <h2 id="form-title">Add New Problem</h2>
    <form id="problem-form">
      <input type="hidden" id="problem-id" value="">
      <label>Title: <input type="text" id="title" required></label><br>
      <label>Description:<br>
        <textarea id="description" required></textarea>
      </label><br>
      <label>Sample Input:<br>
        <textarea id="sample-input"></textarea>
      </label><br>
      <label>Sample Output:<br>
        <textarea id="sample-output"></textarea>
      </label><br>
      <label>Time Limit (seconds): <input type="number" id="time-limit" min="1" value="1"></label><br>
      <label>Difficulty:
        <select id="difficulty">
          <option value="Easy">Easy</option>
          <option value="Medium">Medium</option>
          <option value="Hard">Hard</option>
        </select>
      </label><br>
      <label>Test Cases (JSON Array):<br>
        <textarea id="test-cases" placeholder='[{"input":"1 2","output":"3","isHidden":false}]'></textarea>
      </label><br>
      <button type="submit" id="submit-btn">Add Problem</button>
      <button type="button" id="cancel-btn" style="display:none;">Cancel</button>
    </form>
  </section>
  <!-- Toggle Buttons -->
<div id="toggle-section" style="text-align:center;margin:2em 0;">
    <button id="manage-problems-btn" class="toggle-btn">Manage Problems</button>
    <button id="view-submissions-btn" class="toggle-btn">View Submissions</button>
  </div>
  
  <!-- Submissions Section (initially hidden) -->
  <section id="submissions-section" style="display:none;">
    <h2>Submissions</h2>
    <label>Problem:
      <select id="problem-filter"></select>
    </label>
    <button id="refresh-btn">Refresh</button>
    <table id="submissions-table">
      <thead>
        <tr>
          <th>Participant</th>
          <th>Problem</th>
          <th>Result</th>
          <th>Score</th>
          <th>Submitted At</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <h2>Leaderboard</h2>
    <div id="leaderboard"></div>
    <button id="export-csv-btn" class="toggle-btn">Export Submissions (CSV)</button>
   <button id="export-json-btn" class="toggle-btn">Export Submissions (JSON)</button> 
  </section>
  <section id="analytics-section" style="margin-bottom:2em;">
    <h2>Event Analytics</h2>
    <div id="analytics-content">Loading...</div>
    <button id="refresh-analytics-btn" class="toggle-btn">Refresh Analytics</button>
    <button id="rejudge-btn" class="toggle-btn">Rejudge Selected Problem</button>
  </section>
  <!-- Test Cases Modal (add just before </body>) -->
<div id="test-cases-modal" style="display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%); background:#fff; border-radius:8px; box-shadow:0 2px 8px #0003; padding:2em; z-index:1000; max-width:600px;">
  <h3>Test Cases</h3>
  <div id="test-cases-list"></div>
  <button onclick="closeTestCasesModal()">Close</button>
</div>
<div id="modal-overlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0005; z-index:999;"></div>
<div id="global-spinner" style="display:none; position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:2000; background:rgba(255,255,255,0.6);">
  <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);">
    <div class="spinner"></div>
  </div>
</div>
<div id="toast" style="display:none;position:fixed;bottom:2em;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:1em 2em;border-radius:8px;z-index:3000;font-size:1.1em;"></div>
  <script src="manage.js"></script>

</body>
</html>